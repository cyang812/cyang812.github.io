title: 前导零计数
date: 2018-08-02 19:58:19
tags:
- C语言
- 嵌入式
- Xtensa
- ARM
categories:
- 嵌入式
thumbnail: http://blog.cyang.top/clz/arm.jpg?imageView2/0/interlace/1/q/100|watermark/2/text/Y3lhbmcudGVjaA==/font/Y29uc29sYXM=/fontsize/720/fill/I0Q0RUVGMQ==/dissolve/69/gravity/SouthEast/dx/10/dy/10
---

# 前导零计数
计算一个 32位 数头部 0 的个数。例如 1 前面有 31 个0， 0 则前面有 32 个0。

<!-- more -->

## C 语言实现
```c
int cntLeadingZeros(uint32_t i)
{
	int ret = 0;
	uint32_t temp = ~i;

	while(temp & 0x80000000)
	{
		temp <<= 1;
		ret++;
	}
	return ret;
}
```

## 硬件指令
在 ARM 和 Xtensa 架构的硬件中，具有单独的指令可以完成前导0计算。
在 ARM 下是 `clz` 指令； 在 Xtensa 下是 `NSAU` 指令，用法一样。

![ARM](http://blog.cyang.top/clz/arm.jpg?imageView2/0/interlace/1/q/100|watermark/2/text/Y3lhbmcudGVjaA==/font/Y29uc29sYXM=/fontsize/720/fill/I0Q0RUVGMQ==/dissolve/69/gravity/SouthEast/dx/10/dy/10)
![xtensa](http://blog.cyang.top/clz/xtensa.jpg?imageView2/0/interlace/1/q/100|watermark/2/text/Y3lhbmcudGVjaA==/font/Y29uc29sYXM=/fontsize/720/fill/I0Q0RUVGMQ==/dissolve/69/gravity/SouthEast/dx/10/dy/10)

### 内嵌汇编实现
```c
int cntLeadingZeros(uint32_t i)
{
	int ret = 0;
	__asm("clz %0, %1 ": "=r"(i) : "r"(ret));  //arm
	__asm("nsau %0, %1 ": "=r"(i) : "r"(ret)); //xtensa
	return ret;
}
```

##  其他
[leetcode 题目 476](https://leetcode.com/problems/number-complement/description/)
